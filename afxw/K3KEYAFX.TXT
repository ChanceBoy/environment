【概要】
二画面ファイラ「あふ」のキーカスタマイズツールをVBで作ってみました。
VB6のランタイムが必要です。


【使用法】
AFX.KEYのあるディレクトリで実行してください。
AFX.KEYがなかった場合には保存時に作成します。

中央のラジオボタンで編集するセクションを選択します。

キーリストをクリックするとキーが選択状態になり、下方にアサインされている機能のガイダンスが表示されます。
機能リストをクリックすると機能が選択状態になり、中央にアサインされているキー一覧が表示されます。
機能リストをダブルクリックすると選択されているキーに機能がアサインされます。
キーアサインリスト一覧をクリックすると対応するキーリストが選択状態になります。
機能ガイダンスをクリックすると対応する機能リストが選択状態になります。


[設定]ボタンを押すと選択されているキーに選択されている機能がアサインされます。
　　　外部命令が記述されている状態では外部命令が登録されます。
　　　外部命令の記述は[CL]ボタンでクリアできます。
　　　（機能リストのダブルクリックでは外部命令は自動的にクリアされます）

[削除]ボタンを押すと選択されいてるキーから機能を削除します。

[デフォルト]ボタンを押すと選択されているキーの機能をデフォルトに戻します。

[Shift入替]ボタンを押すと0-9,A-Zキーのシフト設定を入れ替えるサブウィンドウを開きます。
　主に、Ctrl+英数での頭文字ジャンプの機能を他のシフトキーに割り振りたい時に使用します。
　入れ替えたいシフト状態をチェックボックスで設定し、[実行]ボタンを押してください。

[再読込]ボタンを押すとAFX.KEYを読み直します。

[決定]ボタンを押すとAFX.KEYを更新してプログラムを終了します。

AFX本体にデフォルトのキーアサインを持つ機能が追加された場合、K3KEYAFXでは未知の機能となります。
新たに追加された機能を使う場合は外部命令に「:nnnn」の書式で登録することができます。
「nnnn」はシフト状態と仮想キーコードを含む10進数4桁の数字です。（AFXKEY.TXT参照）

デフォルトのキーアサインはK3KEYAFX.DEFで設定できるようにしましたので、自分で機能追加できます。
K3KEYAFX.DEFの書式は
"機能名",キーコード(,キーコード2)...
まぁ、同梱のK3KEYAFX.DEFを見てください。

【制限】
書き込む前にセクションを丸ごと削除しているのでセクションの順番が変わります。
INIファイルの特定のキーだけを削除する方法を知らないので…（間抜けだのぉ）
あちゃるつもりはありませんので対応を待っていても無駄です。
あちゃりたい人は自力であちゃってください。
コマンドバッファは128取ってあったけど、なんか小さいらしいので拡大、、、1024もありゃ文句あるめぇ。
101キー？何それ？食えるのか？

【補足】
動作確認が十分ではないのでオリジナルのAFX.KEYのバックアップを忘れずに。
このプログラムが元で何かトラブっても責任はもてません。
頭文字ジャンプ定義を全部一覧に放り込んだため、一覧がえらく巨大になったけど、それはそれ。

VBランタイムがない場合は多分激しく文字化けします。
システムフォントを変更しても文字化けするらしいけど、ホント？（VBでの対応方法教えてくれたら対応するけど）

簡易内蔵テキストビュア画面のキャレットモードは意識していないのでいぢりたい人は自力で対応よろしく。

とりあえずAFXW.KEYを編集できるようにはしたけど、雲丹対応は現状では厳しいわ…

【履歴】
---------------
0.00  2001.04.18 とりあえず作ってみた
0.01  2001.04.18 とりあえず後悔^H^H公開してみた
0.02  2001.04.22 操作性を向上させた
                 デフォルトボタンを追加した
                 テキストビューワ・画像ビューワのキーカスタマイズに対応した
                 置換文字、内部命令のTIPSを「あふ」本体からコピーして貼り付けた
0.02a 2001.04.22 機能削除にバグがあったのを修正
0.02b 2001.04.22 ファイル書き込み方法を少し修正
0.03  2001.08.23 [ESC]キーでプログラム終了するようにした
                 [Shift]+[_]のデフォルトをコンテキストメニューに修正
                 [Shift]+[Q]のデフォルトを終了に修正
                 「フォルダ履歴を戻る/進む」を追加
                 「フルスクリーン」「フルスクリーンでステータスバー表示」を追加
0.03a 2001.08.24 tips変更
0.03b 2001.09.28 リッチエディットのランタイム関係で動かないのがウザイのでTIPSやめ
0.04  2002.02.18 K3KEYAFXで内部未定義のキー入替設定は外部命令登録扱いにした
                 テキストビューの行間調整定義を追加
                 Ctrl+英数の頭文字ジャンプの設定を追加
                 0-9,A-Zのシフト状態を入れ替えるボタンを追加
                 ※リリース時の「あふ」バージョン0.127
0.04a 2002.03.02 「ワイルドカードマークの選択/直接入力」を追加
                 「画像サイズを画面に合わすモード」を追加
                 ※リリース時の「あふ」バージョン0.129
0.04b 2002.03.06 外部命令に全角文字が含まれると登録が正常に行われなかった不具合を修正
                 ※リリース時の「あふ」バージョン0.130b1
0.05  2002.07.10 「外部命令登録」ボタンを廃止し、操作体系を変更
                 「共有フォルダの列挙」を追加
                 カスタマイズ可能なキーに[Pause][ScrLk][カナ][変換][無変換]を追加
                 ※リリース時の「あふ」バージョン0.147
0.05a 2002.12.03 「終了(設定保存なし)」を追加
                 ファンクションキーの設定を追加(ファンクションキーの内容はAFXCFGで設定)
                 「ｷﾀ━━━(ﾟ∀ﾟ)━━━!!」（暫定らしい）
                 ※リリース時の「あふ」バージョン0.157b4
0.05b (非公開)   「ファイル名省略位置変更」を追加
                 「補完モード切替」を追加
                 afxmouseの右クリックに対応
                 ※リリース時の「あふ」バージョン0.168b2
0.05c 2004.12.08 「内部表示画像消去」を追加
                 ※リリース時の「あふ」バージョン0.181
0.05d 2006.02.14 簡易内蔵テキストビュア画面「対象を前ファイルへ」「対象を次ファイルへ」を追加
                 画像ビュア画面「マーク(反転)して終了(カーソル上)」を追加
                 「アイコン表示」を追加
                 簡易内蔵テキストビュア画面「テキストメニュー」が抜けていたのを追加
                 ※リリース時の「あふ」バージョン0.190b5
0.05e 2006.02.17「行間を縮める」「行間を広げる」を追加
                 コマンドバッファを拡大
0.05f 2007.11.28「サムネイル表示」「サムネイルの拡大」「サムネイルの縮小」を追加
                「右DnDメニュー」を追加
                「あふをもう１つ開く（作業中）」を追加
                 ※リリース時の「あふ」バージョン0.206
0.06  2007.12.22 キー定義ファイル(K3KEYAFX.DEF)があればデフォルト設定を読み込むように変更
                「擬似ドロップ先選択ウインドウ」を追加
                 画像ビュア画面「カーソル位置表示切替」「フォント縮小」「フォント拡大」を追加
                 簡易内蔵テキストビュア画面も「フォント縮小」「フォント拡大」が抜けてた
                 ※リリース時の「あふ」バージョン0.207
0.06a 2008.10.20 テンキーの[/]が無視されていたので登録リストに追加
                 ついでだから[F13]〜[F15]もなんかあったらいけないので追加
                 「他方の再読込（マーククリア）」「再読込（マーク保持）」「他方の再読込（マーク保持）」を追加
                 「ファイル名クリップボード転送メニュー」を追加
                 画像ビュア画面「(カーソルページアップ)」「(カーソルページダウン)」「画像表示場所切替」を追加
                 ※リリース時の「あふ」バージョン1.0
0.07  2008.10.21 キー定義ファイル(K3KEYAFX.DEF)を必須とした
                 内部処理でバッファが不足している部分があったのでバッファ領域を確保した
                 ※リリース時の「あふ」バージョン1.0
0.07a 2008.10.22 0.07がバグバグで使い物にならなかったので修正（スマンかった orz）
                 ※リリース時の「あふ」バージョン1.0
0.07b 2008.10.23 0.07aでデバッグ用の削除ルーチンで異常動作があったのを修正
                 ※リリース時の「あふ」バージョン1.0
0.07c 2009.04.22 あふのキー設定ファイル名をキー定義ファイル内で指定可能にした（AFXW.KEY暫定対応）
                 ※リリース時の「あふ」バージョン1.3α

恵三
mailto:k3kato@yahoo.co.jp
http://www.geocities.jp/spade_k3kato/ 
